union isfuzzy=true CosmosDBDataPlaneRequests | project TimeGenerated, StatusCode, DatabaseName, ContainerName, OperationName, RequestCharge, DurationMs | union (AzureDiagnostics | where Category has 'DataPlaneRequests' | project TimeGenerated, StatusCode=tostring(statusCode_s), DatabaseName=databaseName_s, ContainerName=collectionName_s, OperationName=operationName_s, RequestCharge=toreal(requestCharge_s), DurationMs=todouble(duration_s)) | where tostring(StatusCode) == '429' | summarize Throttles=count(), AvgRU=avg(RequestCharge) by DatabaseName, ContainerName, OperationName | top 200 by Throttles desc
